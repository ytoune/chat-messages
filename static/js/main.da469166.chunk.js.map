{"version":3,"sources":["talk/index.js","talk/consts.js","subjects/part.js","talk/set.js","talk/Message.js","talk/delay.js","talk/DateForm.js","talk/EnumForm.js","talk/Link.js","talk/getStory.js","subjects/story.js","App.js","index.js"],"names":["vars","CLEAR","NO_CHANGE","part","ReplaySubject","pushPart","item","next","table","set","name","value","of","Message","text","react_default","a","createElement","replace","_","delay","ms","Promise","s","setTimeout","usleep","DateForm","res","Form","_Component","_getPrototypeOf2","_this","Object","classCallCheck","this","_len","arguments","length","p","Array","_key","possibleConstructorReturn","getPrototypeOf","call","apply","concat","state","v","inherits","createClass","key","_this2","onSubmit","e","setState","preventDefault","type","onChange","_ref","target","onClick","Component","pipe","concatMap","num","r","filter","EnumForm","enums","map","str","Link","title","href","getStory","names","query","reduce","o","objectSpread","defineProperty","file","n","fetch","stringify","then","json","story","switchMap","body","el","document","querySelector","innerText","from","_ref2","toArray","method","args","slice","fn","toConsumableArray","scan","lst","c","cloneElement","App","withStyles","root","margin","padding","width","minHeight","$","subscribe","bind","unsubscribe","props","classes","className","resolve","book","render","App_App","getElementById","catch","console","log"],"mappings":"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","file":"static/js/main.da469166.chunk.js","sourcesContent":["\nimport { of } from 'rxjs'\n\nimport { set } from './set'\nimport { Message } from './Message'\nimport { delay } from './delay'\nimport { DateForm } from './DateForm'\nimport { EnumForm } from './EnumForm'\nimport { Link } from './Link'\nimport { getStory } from './getStory'\n\nexport {\n\tCLEAR,\n\tNO_CHANGE,\n} from './consts'\n\nexport const talk = vars => ([method, ...args]) => {\n\n\tconst fn = table[method]\n\n\tconst view =\n\t\tfn ?\n\t\t\tfn(vars, ...args) :\n\t\t\tof()\n\n\treturn view\n\n}\n\nconst table = {\n\tset,\n\tMessage,\n\tdelay,\n\tDateForm,\n\tEnumForm,\n\tLink,\n\tgetStory,\n}\n","\nexport const CLEAR = {CLEAR: 'CLEAR'}\nexport const NO_CHANGE = {NO_CHANGE: 'NO_CHANGE'}\n","\nimport { ReplaySubject } from 'rxjs'\n\nexport const part = new ReplaySubject()\n\nexport const pushPart = item => part.next(item)\n","\nimport { of } from 'rxjs'\n\nexport const set = (vars, name, value) => {\n\tvars[name] = value\n\treturn of()\n}\n","\nimport React from 'react'\nimport { of } from 'rxjs'\n\nexport const Message = (vars, text) => of(\n\t<p>{text.replace(/__([a-zA-Z0-9]+)__/gui, (_, name) => vars[name])}</p>\n)\n","\n\nexport const usleep = ms => new Promise(s => setTimeout(s, ms))\n\nexport const delay = (_, ms) => usleep(ms)\n","\nimport React, { Component } from 'react'\nimport { of } from 'rxjs'\nimport { concatMap, filter } from 'rxjs/operators'\n\nexport const DateForm = (vars, name) => {\n\tlet res\n\tclass Form extends Component {\n\t\tconstructor(...p) {\n\t\t\tsuper(...p)\n\t\t\tthis.state = {\n\t\t\t\tv: '1990-01-01',\n\t\t\t\tp: false,\n\t\t\t}\n\t\t}\n\t\trender() {\n\t\t\tif (this.state.p) return null\n\t\t\tconst onSubmit = e => {\n\t\t\t\tvars[name] = this.state.v\n\t\t\t\tthis.setState({p: true})\n\t\t\t\tres()\n\t\t\t\te.preventDefault()\n\t\t\t\treturn false\n\t\t\t}\n\t\t\treturn <form onSubmit={onSubmit}>\n\t\t\t\t<input type=\"date\" value={this.state.v} onChange={({target: {value}}) => this.setState({v: value})}/>\n\t\t\t\t<button onClick={onSubmit}>ok</button>\n\t\t\t</form>\n\t\t}\n\t}\n\treturn of(1, 0).pipe(\n\t\tconcatMap(\n\t\t\tnum => num ?\n\t\t\t\tof(<Form/>) :\n\t\t\t\tnew Promise(r => res = r)\n\t\t),\n\t\tfilter(_ => _),\n\t)\n}\n","\nimport React, { Component } from 'react'\nimport { of } from 'rxjs'\nimport { concatMap, filter } from 'rxjs/operators'\n\nexport const EnumForm = (vars, name, enums) => {\n\tlet res\n\tclass Form extends Component {\n\t\tconstructor(...p) {\n\t\t\tsuper(...p)\n\t\t\tthis.state = {\n\t\t\t\tp: false,\n\t\t\t}\n\t\t}\n\t\trender() {\n\t\t\tif (this.state.p) return null\n\t\t\tconst select = v => {\n\t\t\t\tvars[name] = v\n\t\t\t\tthis.setState({p: true})\n\t\t\t\tres()\n\t\t\t}\n\t\t\treturn <div>\n\t\t\t\t{enums.map(str => (\n\t\t\t\t\t<button key={str} onClick={() => select(str)}>{str}</button>\n\t\t\t\t))}\n\t\t\t</div>\n\t\t}\n\t}\n\treturn of(1, 0).pipe(\n\t\tconcatMap(\n\t\t\tnum => num ?\n\t\t\t\tof(<Form/>) :\n\t\t\t\tnew Promise(r => res = r)\n\t\t),\n\t\tfilter(_ => _),\n\t)\n}\n","\nimport React from 'react'\nimport { of } from 'rxjs'\n\n/* eslint-disable react/jsx-no-target-blank */\nexport const Link = (vars, title, href) => of(\n\t<div>\n\t\t<a href={href} target=\"_blank\">{title}</a>\n\t</div>\n)\n/* eslint-enable */\n","\nimport { of } from 'rxjs'\nimport { concatMap, filter } from 'rxjs/operators'\nimport { CLEAR } from './consts'\n\nimport { pushPart } from '../subjects/part'\n\nimport { stringify } from 'query-string'\n\nexport const getStory = (vars, names) => {\n\tconst query = names.reduce((o, name) => ({...o, [name]: vars[name]}), {})\n\tconst {file} = vars\n\treturn of(1, 0).pipe(\n\t\tconcatMap(\n\t\t\tn => n ?\n\t\t\t\tof(CLEAR) :\n\t\t\t\tfetch(`./${file}?${stringify(query)}`)\n\t\t\t\t\t.then(r => r.json())\n\t\t\t\t\t.then(pushPart)\n\t\t\t\t\t.then(() => null)\n\t\t),\n\t\tfilter(_ => _),\n\t)\n}\n","\nimport { cloneElement } from 'react'\n\nimport { from } from 'rxjs'\nimport { switchMap, concatMap, filter, scan } from 'rxjs/operators'\n\nimport { talk, NO_CHANGE, CLEAR } from '../talk'\n\nimport { part } from './part'\n\nexport const story =\n\tpart.pipe(\n\t\tswitchMap(\n\t\t\t({title, body}) => {\n\t\t\t\tconst el = document.querySelector('title')\n\t\t\t\tif (el && title) el.innerText = title\n\t\t\t\treturn from(body)\n\t\t\t}\n\t\t),\n\t\tconcatMap(talk({})),\n\t\tfilter(v => NO_CHANGE !== v && v),\n\t\tscan(\n\t\t\t(lst, c) =>\n\t\t\t\tCLEAR === c ?\n\t\t\t\t\t[] :\n\t\t\t\t\t[...lst, cloneElement(c, {key: lst.length})],\n\t\t\t[]\n\t\t),\n\t)\n","\nimport React, { Component } from 'react'\n\nimport { withStyles } from '@material-ui/core/styles'\n\nimport { story } from './subjects'\nimport { map } from 'rxjs/operators'\n\nexport const App = withStyles({\n\troot: {\n\t\tmargin: 0,\n\t\tpadding: 0,\n\t\twidth: '100%',\n\t\tminHeight: '100vh',\n\t},\n})(class App extends Component {\n\tconstructor(...p) {\n\t\tsuper(...p)\n\t\tthis.state = {}\n\t}\n\tcomponentDidMount() {\n\t\tthis.$ = story.pipe(map(story => ({story}))).subscribe(this.setState.bind(this))\n\t}\n\tcomponentWillUnmount() {\n\t\tthis.$.unsubscribe()\n\t\tthis.$ = null\n\t}\n\trender() {\n\t\tconst {\n\t\t\tprops: {\n\t\t\t\tclasses: {root},\n\t\t\t},\n\t\t\tstate: {\n\t\t\t\tstory,\n\t\t\t}\n\t\t} = this\n\t\treturn (\n\t\t\t<div className={root}>\n\t\t\t\t{story}\n\t\t\t</div>\n\t\t)\n\t}\n})\n","\nimport React from 'react'\nimport { render } from 'react-dom'\n\nimport { App } from './App'\nimport { pushPart } from './subjects/part'\n\nconst main = () => {\n\n\tfetch('./story.json')\n\t\t.then(r => r.json())\n\t\t.then(book => pushPart(book))\n\n\trender(<App/>, document.getElementById('screen'))\n\n}\n\nPromise.resolve().then(main).catch(console.log.bind(console))\n"],"sourceRoot":""}